<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Mission Parameter</title>

    <style>
      html {
        font-family: sans-serif;
      }
      body {
        width: 50%;
        max-width: 800px;
        min-width: 480px;
        margin: 0 auto;
      }
      .result {
        color: black;
        padding: 3px;
      }
      .slider {
        -webkit-appearance: none;
        width: 100%;
        height: 15px;
        border-radius: 5px;  
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
      }

      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        border-radius: 50%; 
        background: #4CAF50;
        cursor: pointer;
      }

      .slider::-moz-range-thumb {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: #4CAF50;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
      <h1>Mission Parameter</h1>

      <p>Please enter the basic mission parameters</p>

    <div class="form">
      <label for="missionName">Mission name: </label>
      <input type="text" id="missionName" class="missionName">
    </div>

    <div class="form">
      <label for="worldName">World name: </label>
      <input type="text" id="worldName" class="worldName">
    </div>

    <div class="form">
      <label for="date">Date: </label>
      <input type="date" id="datefield" name="datefield" value="2018-07-22" min="1900-01-01" max="2199-12-31">
    </div>

    <div class="form">
      <label for="time">Please choose a : </label>
      <input type="time" id="timefield" name="timefield" value="13:37" min="00:00" max="23:59">
    </div>

    <div class="slidecontainer">
      <input type="range" min="0" max="100" value="50" class="slider" id="myRange">
    </div>

    <div class="form"></div>
      <select id="pet-select">
        <option value="">--Please choose an option--</option>
        <option value="dog">Dog</option>
        <option value="cat">Cat</option>
        <option value="hamster">Hamster</option>
        <option value="parrot">Parrot</option>
        <option value="spider">Spider</option>
        <option value="goldfish">Goldfish</option>
      </select>
    </div>

    <div class="form">
      <input type="submit" value="Next" class="nextPage">
    </div>

    <div class="resultParas">
      <p class="result"></p>
    </div>

  </body>
  <script>
    let missionName = document.querySelector('.missionName');
    let worldName = document.querySelector('.worldName');
    let resultPage = document.querySelector('.result');
    let nextPage = document.querySelector('.nextPage');

    let today = new Date();
    let dd = today.getDate();
    let mm = today.getMonth()+1; //January is 0!
    let yyyy = today.getFullYear();

    if(dd<10){
      dd='0'+dd
    } 

    if(mm<10){
      mm='0'+mm
    } 

    today = yyyy+'-'+mm+'-'+dd;
    document.getElementById("datefield").setAttribute("value", today);

    const worldNames = [["altis", "altis"], ["stratis", "stratis"], ["livonia", "enoch"]];

    function escapeRegExp(str) {
      return str.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    }
    function replaceAll(str, find, replace) {
      return str.replace(new RegExp(escapeRegExp(find), 'g'), replace);
    }

    function fnNextPage() {
      let missionNameValue = missionName.value;
      let worldNameValue = worldName.value;

      let missionNamePBO = replaceAll(missionNameValue, ' ', '_'); 


      missionNamePBO = missionNamePBO.toLowerCase();
      worldNameValue = worldNameValue.toLowerCase();

      let result = "";
      for( let i = 0, len = worldNames.length; i < len; i++ ) {
          if(worldNames[i][0] === worldNameValue || worldNames[i][1] === worldNameValue) {
              result = worldNames[i][1];
              break;
          }
      }

      let filename = "PBO Name: " + missionNamePBO + "." + result;
      
      if (result === "") {
        filename = "World not found, PBO name: " + missionNamePBO + "." + worldNameValue;
        resultPage.style.backgroundColor = 'yellow';
      }

      resultPage.textContent = filename;
    }

    nextPage.addEventListener('click', fnNextPage);

    function myFunction() {
      document.getElementById("myDropdown").classList.toggle("show");
    }

    var slider = document.getElementById("myRange");
    var output = document.getElementById("demo");
    output.innerHTML = slider.value; // Display the default slider value

    // Update the current slider value (each time you drag the slider handle)
    slider.oninput = function() {
      output.innerHTML = this.value;
    } 

    // Close the dropdown menu if the user clicks outside of it
    window.onclick = function(event) {
      if (!event.target.matches('.dropbtn')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }
  </script>
</html>